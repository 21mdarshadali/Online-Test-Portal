<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Result Detail | Admin</title>
  <style>
    body { font-family: Arial; background:#f5f6fa; }
    .box { max-width:900px; margin:20px auto; background:#fff; padding:20px; border-radius:8px; }
    .q { margin:15px 0; padding:15px; border-left:5px solid #ddd; }
    .correct { border-color:#4CAF50; background:#e8f5e9; }
    .wrong { border-color:#f44336; background:#ffebee; }
    .ua { border-color:#9e9e9e; background:#f5f5f5; }
  </style>
</head>
<body>

<div class="box">
  <h2>ðŸ“„ Result Detail</h2>
  <div id="content">Loading...</div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCCuXVMiWIJuIt5Xsp2FATyuj7KNSnTC9c",
    authDomain: "online-test-portal-e2c48.firebaseapp.com",
    projectId: "online-test-portal-e2c48",
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");

  const box = document.getElementById("content");

  db.collection("testResults").doc(id).get().then(doc => {
    if (!doc.exists) return box.innerHTML = "No data found";

    const d = doc.data();
    let html = `
      <p><b>Name:</b> ${d.name}</p>
      <p><b>Course:</b> ${d.course}</p>
      <p><b>Score:</b> ${d.score}%</p>
      <hr>
    `;

    d.questions.forEach(q => {
      html += `
        <div class="q ${q.status === 'correct' ? 'correct' : q.status === 'wrong' ? 'wrong' : 'ua'}">
          <b>Q${q.questionNumber}:</b> ${q.question}<br>
          <b>Your Answer:</b> ${q.userAnswer || 'Not Attempted'}<br>
          <b>Correct Answer:</b> ${q.correctAnswer}
        </div>
      `;
    });

    box.innerHTML = html;
  });
</script>
</body>
</html>
